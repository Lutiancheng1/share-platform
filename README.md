# Share Platform (è·¨è®¾å¤‡å…±äº«å¹³å°)

ä¸€ä¸ªç°ä»£åŒ–çš„è·¨è®¾å¤‡æ–‡ä»¶å’Œæ–‡æœ¬å…±äº«å¹³å°ï¼Œæ”¯æŒå®æ—¶é€šä¿¡ã€æ–‡ä»¶æ‹–æ‹½ä¸Šä¼ ã€å›¾ç‰‡é¢„è§ˆç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **å®æ—¶é€šä¿¡**: åŸºäº Socket.IO çš„å®æ—¶æ¶ˆæ¯åŒæ­¥
- **æ–‡ä»¶å…±äº«**: æ”¯æŒæ‹–æ‹½ä¸Šä¼ æ–‡ä»¶å’Œå›¾ç‰‡
- **å›¾ç‰‡é¢„è§ˆ**: é›†æˆ `react-photo-view`ï¼Œæ”¯æŒç¼©æ”¾ã€å¹³ç§»å’Œæ—‹è½¬
- **å¤šç«¯é€‚é…**: å“åº”å¼è®¾è®¡ï¼Œå®Œç¾é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- **å±€åŸŸç½‘è®¿é—®**: è‡ªåŠ¨è·å–å±€åŸŸç½‘ IPï¼Œæ–¹ä¾¿åŒä¸€ç½‘ç»œä¸‹çš„è®¾å¤‡äº’è”
- **è®¿å®¢æœºåˆ¶**: æ”¯æŒç”Ÿæˆé‚€è¯·é“¾æ¥ï¼Œè®¿å®¢å…ç™»å½•å³å¯åŠ å…¥
- **Markdown**: å®Œå–„çš„æ–‡æ¡£å’Œä»£ç å±•ç¤ºæ”¯æŒ

## ğŸ›  æŠ€æœ¯æ ˆ

### Frontend (å‰ç«¯)
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **UI Library**: Tailwind CSS, Radix UI
- **State/Icons**: Lucide React
- **Image Preview**: react-photo-view

### Backend (åç«¯)
- **Framework**: NestJS
- **Language**: TypeScript
- **Real-time**: Socket.IO
- **File Handling**: Multer

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæœ¬åœ°å¼€å‘

#### 1. ç¯å¢ƒè¦æ±‚
- Node.js >= 18
- npm or yarn or pnpm

#### 2. å®‰è£…ä¾èµ–

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
./start.sh
```

æˆ–è€…æ‰‹åŠ¨å®‰è£…ï¼š

```bash
# å®‰è£…å‰ç«¯ä¾èµ–
cd packages/frontend
npm install

# å®‰è£…åç«¯ä¾èµ–
cd ../backend
npm install
```

#### 3. å¯åŠ¨é¡¹ç›®

æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„å¯åŠ¨è„šæœ¬ï¼Œå¯ä»¥åŒæ—¶å¯åŠ¨å‰ç«¯å’Œåç«¯æœåŠ¡ï¼š

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
./start.sh
```

å¯åŠ¨åï¼š
- **å‰ç«¯åœ°å€**: `http://localhost:3000` (æˆ–å±€åŸŸç½‘ IP:3000)
- **åç«¯åœ°å€**: `http://localhost:3001` (æˆ–å±€åŸŸç½‘ IP:3001)

---

### æ–¹å¼äºŒï¼šDocker éƒ¨ç½²ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

#### 1. ç¯å¢ƒè¦æ±‚
- Docker
- Docker Compose

#### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶å¹¶ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š

```bash
cp .env.example .env
```

ä¸»è¦é…ç½®é¡¹ï¼š
```env
# æ•°æ®åº“
POSTGRES_PASSWORD=your_password

# JWT å¯†é’¥
JWT_SECRET=your_secret_key

# ç®¡ç†å‘˜å¯†ç 
ACCESS_PASSWORD=admin123
```

#### 3. æ„å»ºå’Œå¯åŠ¨

åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
# æ„å»ºé•œåƒ
docker compose build

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d
```

#### 4. è®¿é—®åº”ç”¨

å¯åŠ¨æˆåŠŸåï¼Œé€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š
- **å‰ç«¯**: `http://localhost:3000` æˆ– `http://æœåŠ¡å™¨IP:3000`
- **åç«¯ API**: `http://localhost:3001` æˆ– `http://æœåŠ¡å™¨IP:3001`

#### 5. é˜²ç«å¢™é…ç½®

**æœåŠ¡å™¨é˜²ç«å¢™ï¼ˆufwï¼‰:**
```bash
ufw allow 3000/tcp  # å‰ç«¯
ufw allow 3001/tcp  # åç«¯
ufw reload
```

**äº‘æœåŠ¡å•†å®‰å…¨ç»„ï¼ˆå¦‚æœéƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ï¼‰:**
- å…¥ç«™è§„åˆ™æ·»åŠ ï¼š3000/TCPã€3001/TCP
- æˆæƒå¯¹è±¡ï¼š0.0.0.0/0ï¼ˆæˆ–ç‰¹å®š IP æ®µï¼‰

#### 6. Docker ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹æ—¥å¿—
docker compose logs frontend
docker compose logs backend

# é‡å¯æœåŠ¡
docker compose restart

# åœæ­¢æœåŠ¡
docker compose down

# å®Œå…¨é‡æ–°æ„å»º
docker compose build --no-cache
docker compose up -d
```

---

### å¸¸ç”¨å¼€å‘å‘½ä»¤

#### å‰ç«¯
```bash
cd packages/frontend
npm run dev   # å¼€å‘æ¨¡å¼
npm run build # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm start     # è¿è¡Œç”Ÿäº§ç‰ˆæœ¬
```

#### åç«¯
```bash
cd packages/backend
npm run start:dev # å¼€å‘æ¨¡å¼
npm run build     # æ„å»º
npm run start:prod # è¿è¡Œç”Ÿäº§ç‰ˆæœ¬
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
share-platform/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ frontend/          # Next.js å‰ç«¯é¡¹ç›®
â”‚   â”‚   â”œâ”€â”€ app/           # é¡µé¢è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ components/    # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ lib/           # å·¥å…·å‡½æ•°å’Œç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ Dockerfile     # å‰ç«¯å®¹å™¨é…ç½®
â”‚   â””â”€â”€ backend/           # NestJS åç«¯é¡¹ç›®
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ modules/   # ä¸šåŠ¡æ¨¡å— (upload, invite, etc.)
â”‚       â”‚   â””â”€â”€ ...
â”‚       â””â”€â”€ Dockerfile     # åç«¯å®¹å™¨é…ç½®
â”œâ”€â”€ docker-compose.yml     # Docker ç¼–æ’é…ç½®
â”œâ”€â”€ start.sh               # æœ¬åœ°å¼€å‘å¯åŠ¨è„šæœ¬
â””â”€â”€ .env.example           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
```

## ğŸ— æ¶æ„è¯´æ˜

### Docker æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             æœåŠ¡å™¨ï¼ˆHost Networkï¼‰       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend (3000)  â†â†’  Backend (3001)    â”‚
â”‚                         â†“                â”‚
â”‚          PostgreSQL (5433) + Redis (6380)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç½‘ç»œæ¨¡å¼**: ä½¿ç”¨ `network_mode: host`ï¼Œå®¹å™¨ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ

**ç«¯å£æ˜ å°„**:
- å‰ç«¯: 3000
- åç«¯: 3001
- PostgreSQL: 5433 (å¤–éƒ¨) â†’ 5432 (å®¹å™¨å†…)
- Redis: 6380 (å¤–éƒ¨) â†’ 6379 (å®¹å™¨å†…)

### API è·¯ç”±
- `POST /api/auth/admin/login` - ç®¡ç†å‘˜ç™»å½•
- `POST /api/auth/guest/login` - è®¿å®¢ç™»å½•
- `POST /api/upload/file` - æ–‡ä»¶ä¸Šä¼ 
- `GET /api/messages` - è·å–æ¶ˆæ¯åˆ—è¡¨
- WebSocket: `/socket.io/` - å®æ—¶é€šä¿¡

## ğŸ“ æ³¨æ„äº‹é¡¹

### æœ¬åœ°å¼€å‘
- ç¡®ä¿ 3000 å’Œ 3001 ç«¯å£æœªè¢«å ç”¨
- å±€åŸŸç½‘è®¿é—®æ—¶ï¼Œè¯·ç¡®ä¿é˜²ç«å¢™å…è®¸é€šè¿‡è¿™ä¸¤ä¸ªç«¯å£

### ç”Ÿäº§éƒ¨ç½²
- **åŠ¡å¿…ä¿®æ”¹** `.env` ä¸­çš„å¯†ç å’Œå¯†é’¥
- ç¡®ä¿äº‘æœåŠ¡å•†å®‰å…¨ç»„å·²å¼€æ”¾ 3000 å’Œ 3001 ç«¯å£
- ä¸Šä¼ æ–‡ä»¶å¤§å°é™åˆ¶é»˜è®¤ä¸º 50MBï¼ˆå¯åœ¨åç«¯é…ç½®ä¸­ä¿®æ”¹ï¼‰
- å»ºè®®é…ç½® HTTPSï¼ˆå¯é€šè¿‡ Nginx åå‘ä»£ç†å®ç°ï¼‰
- å®šæœŸå¤‡ä»½æ•°æ®åº“æ•°æ®

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ License

MIT
